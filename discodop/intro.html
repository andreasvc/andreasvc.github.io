<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting started &mdash; Disco-DOP 0.5pre1 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5pre1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Disco-DOP 0.5pre1 documentation" href="index.html" />
    <link rel="next" title="Reference" href="ref.html" />
    <link rel="prev" title="Discontinuous Data-Oriented Parsing: disco-dop" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="ref.html" title="Reference"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="index.html" title="Discontinuous Data-Oriented Parsing: disco-dop"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Disco-DOP 0.5pre1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="getting-started">
<h1><a class="toc-backref" href="#id1">Getting started</a><a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#getting-started" id="id1">Getting started</a><ul>
<li><a class="reference internal" href="#parsing-a-text" id="id2">Parsing a text</a></li>
<li><a class="reference internal" href="#inducing-a-simple-grammar" id="id3">Inducing a simple grammar</a></li>
<li><a class="reference internal" href="#run-an-experiment" id="id4">Run an experiment</a></li>
<li><a class="reference internal" href="#ipython-notebooks" id="id5">IPython notebooks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overview" id="id6">Overview</a><ul>
<li><a class="reference internal" href="#command-line-tools" id="id7">Command-line tools</a></li>
<li><a class="reference internal" href="#web-interfaces" id="id8">Web interfaces</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="parsing-a-text">
<h2><a class="toc-backref" href="#id2">Parsing a text</a><a class="headerlink" href="#parsing-a-text" title="Permalink to this headline">¶</a></h2>
<p>The parser can be used as an off-the-shelf parser using an existing grammar model,
either one of the <a class="reference external" href="http://staff.science.uva.nl/~acranenb/grammars/">grammars used in the 2013 IWPT paper</a> for English, German, and
Dutch, or a model produced by <code class="docutils literal"><span class="pre">discodop</span> <span class="pre">runexp</span></code> or <code class="docutils literal"><span class="pre">discodop</span> <span class="pre">grammar</span> <span class="pre">param</span></code>.
The text needs to be tokenized, for example using <a class="reference external" href="http://ilk.uvt.nl/ucto">ucto</a>, the output of which can be passed to the parser:</p>
<div class="highlight-python"><div class="highlight"><pre>$  ucto -L en -n &quot;CONRAD, Joseph - Lord Jim.txt&quot; | discodop parser wsj/
</pre></div>
</div>
<p>To parse sentences in bracketed format:</p>
<div class="highlight-python"><div class="highlight"><pre>$ discodop treetransforms none treebankExample.mrg --inputfmt=bracket --outputfmt=tokens | discodop parser wsj/
</pre></div>
</div>
</div>
<div class="section" id="inducing-a-simple-grammar">
<h2><a class="toc-backref" href="#id3">Inducing a simple grammar</a><a class="headerlink" href="#inducing-a-simple-grammar" title="Permalink to this headline">¶</a></h2>
<p>Suppose we have the following treebank in the file <code class="docutils literal"><span class="pre">treebankExample.mrg</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>(S (NP (DT The) (NN cat)) (VP (VBP saw) (NP (DT the) (JJ hungry) (NN dog))))
(S (NP (DT The) (NN cat)) (VP (VBP saw) (NP (DT the) (NN dog))))
(S (NP (DT The) (NN mouse)) (VP (VBP saw) (NP (DT the) (NN cat))))
(S (NP (DT The) (NN mouse)) (VP (VBP saw) (NP (DT the) (JJ yellow) (NN cat))))
(S (NP (DT The) (JJ little) (NN mouse)) (VP (VBP saw) (NP (DT the) (NN cat))))
(S (NP (DT The) (NN cat)) (VP (VBP ate) (NP (DT the) (NN dog))))
(S (NP (DT The) (NN mouse)) (VP (VBP ate) (NP (DT the) (NN cat))))
</pre></div>
</div>
<p>You can view the trees using the following command:</p>
<div class="highlight-python"><div class="highlight"><pre>$ discodop treedraw &lt; treebankExample.mrg | less -R
</pre></div>
</div>
<p>Before inducing a grammar, we need to binarize the treebank:</p>
<div class="highlight-python"><div class="highlight"><pre>$ discodop treetransforms binarize --fmt=bracket treebankExample.mrg /tmp/bintrees
transformed 7 trees with action &#39;binarize&#39;
</pre></div>
</div>
<p>We can then induce a Double-DOP grammar with the following command:</p>
<div class="highlight-python"><div class="highlight"><pre>$ discodop grammar doubledop --inputfmt=bracket /tmp/bintrees /tmp/example
extracting recurring fragments
[...]
found 34 fragments
wrote backtransform to /tmp/example.backtransform
wrote grammar to /tmp/example.rules and /tmp/example.lex.
[...]
</pre></div>
</div>
<p>This produces a grammar consisting of a series of text files in <code class="docutils literal"><span class="pre">/tmp</span></code>, which
can be used as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>$ echo &#39;The cat saw the hungry dog&#39; | discodop parser --simple /tmp/example.rules /tmp/example.lex --bt=/tmp/example.backtransform -s S -b 5
parsing 0: The cat saw the hungry dog
(S (NP (DT 0) (NN 1)) (VP (VBP 2) (NP (DT 3) (NP|&lt;JJ,NN&gt; (JJ 4) (NN 5)))))
0.0 s
[...]
</pre></div>
</div>
<p>Note that the <code class="docutils literal"><span class="pre">-s</span></code> option should specify the root label of the trees in the treebank.</p>
</div>
<div class="section" id="run-an-experiment">
<h2><a class="toc-backref" href="#id4">Run an experiment</a><a class="headerlink" href="#run-an-experiment" title="Permalink to this headline">¶</a></h2>
<p>To parse with large treebanks, it may be necessary to apply pruning, and it
is useful to specify the configuration for an experiment in a single file.
This can be done with the <code class="docutils literal"><span class="pre">discodop</span> <span class="pre">runexp</span></code> command.</p>
<p>To run an end-to-end experiment from grammar extraction to evaluation on a test
set, make a copy of the file <code class="docutils literal"><span class="pre">sample.prm</span></code> and edit its parameters. For
example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">stages</span><span class="o">=</span><span class="p">[</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;pcfg&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;pcfg&#39;</span><span class="p">,</span>
        <span class="n">split</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">markorigin</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;plcfrs&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;plcfrs&#39;</span><span class="p">,</span>
        <span class="n">prune</span><span class="o">=</span><span class="s">&#39;pcfg&#39;</span><span class="p">,</span> <span class="n">splitprune</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;dop&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;plcfrs&#39;</span><span class="p">,</span>
        <span class="n">prune</span><span class="o">=</span><span class="s">&#39;plcfrs&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">dop</span><span class="o">=</span><span class="s">&#39;doubledop&#39;</span><span class="p">,</span>
        <span class="n">estimator</span><span class="o">=</span><span class="s">&#39;rfe&#39;</span><span class="p">,</span> <span class="n">objective</span> <span class="o">=</span> <span class="s">&#39;mpp&#39;</span><span class="p">)</span>
<span class="p">],</span>
<span class="n">traincorpus</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s">&#39;alpinosample.export&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;utf-8&#39;</span><span class="p">,</span>
    <span class="n">numsents</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">maxwords</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
<span class="n">testcorpus</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s">&#39;alpinosample.export&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;utf-8&#39;</span><span class="p">,</span>
    <span class="n">numsents</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">maxwords</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">skiptrain</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
<span class="n">postagging</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">method</span><span class="o">=</span><span class="s">&#39;unknownword&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s">&#39;4&#39;</span><span class="p">,</span>
    <span class="n">unknownthreshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">openclassthreshold</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">simplelexsmooth</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
<span class="n">binarization</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">method</span><span class="o">=</span><span class="s">&#39;default&#39;</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">,</span>
    <span class="n">h</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
</pre></div>
</div>
<p>See the documentation on the available <a class="reference internal" href="params.html"><em>parameters</em></a>.
These parameters can be invoked by executing:</p>
<div class="highlight-python"><div class="highlight"><pre>$ discodop runexp filename.prm
</pre></div>
</div>
<p>This will create a new directory with the base name of the parameter file, i.e.,
<code class="docutils literal"><span class="pre">filename/</span></code> in this case. This directory must not exist yet, to avoid
accidentally overwriting previous results. The directory will contain the
grammar rules and lexicon in a text format, as well as the parsing results and
the gold standard file in Negra&#8217;s export format.</p>
<img alt="screenshot of runexp showing a parse tree" src="_images/runexp.png" />
<p>Note that there is an option to utilize multiple processor cores by launching a
specific number of processes. This greatly speeds up parsing, but note that for
a nontrivial DOP grammar, each process may require anywhere from 4GB to 16GB.</p>
<p>Corpora can be read in Negra&#8217;s export format, or in the bracketed Penn
treebank format. Access to the
<a class="reference external" href="http://www.coli.uni-saarland.de/projects/sfb378/negra-corpus/">Negra corpus</a>
can be requested for non-commercial purposes, while the
<a class="reference external" href="http://www.ims.uni-stuttgart.de/projekte/TIGER/TIGERCorpus/">Tiger corpus</a>
is freely available for download for research purposes.</p>
<p>Alternatively, it is possible to achieve similar results with separate commands:</p>
<div class="highlight-python"><div class="highlight"><pre>$ discodop grammar param filename.prm filename/
$ discodop none alpinosample.export sentences.txt --inputfmt=export --outputfmt=tokens
$ discodop parser filename/ sentences.txt --fmt=export &gt;filename/dop.export
$ discodop eval alpinosample.export filename/dop.export proper.prm
</pre></div>
</div>
</div>
<div class="section" id="ipython-notebooks">
<h2><a class="toc-backref" href="#id5">IPython notebooks</a><a class="headerlink" href="#ipython-notebooks" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://nbviewer.ipython.org/gist/andreasvc/9467e27680d8950045b2/treefragments.ipynb">A tutorial on using tree fragments for text classification</a></li>
<li><a class="reference external" href="http://nbviewer.ipython.org/gist/andreasvc/f6f626aadb7fd7fb4954">Getting tree fragments from TSG derivations</a></li>
</ul>
</div>
</div>
<div class="section" id="overview">
<h1><a class="toc-backref" href="#id6">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="command-line-tools">
<h2><a class="toc-backref" href="#id7">Command-line tools</a><a class="headerlink" href="#command-line-tools" title="Permalink to this headline">¶</a></h2>
<p>Aside from the parser there are some standalone tools, invoked as <code class="docutils literal"><span class="pre">discodop</span> <span class="pre">&lt;cmd&gt;</span></code>:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">fragments</span></code></dt>
<dd><p class="first">Finds recurring or common fragments in one or more treebanks.
It can be used with discontinuous as well as Penn-style bracketed treebanks.
Example:</p>
<div class="highlight-python"><div class="highlight"><pre>$ discodop fragments wsj-02-21.mrg &gt; wsjfragments.txt
</pre></div>
</div>
<p class="last">Specify the option <code class="docutils literal"><span class="pre">--numproc</span> <span class="pre">n</span></code> to use multiple processes, as with <code class="docutils literal"><span class="pre">runexp</span></code>.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">eval</span></code></dt>
<dd><p class="first">Discontinuous evaluation. Reports F-scores and other metrics.
Accepts <code class="docutils literal"><span class="pre">EVALB</span></code> parameter files:</p>
<p class="last"><code class="docutils literal"><span class="pre">$</span> <span class="pre">discodop</span> <span class="pre">eval</span> <span class="pre">sample/gold.export</span> <span class="pre">sample/dop.export</span> <span class="pre">proper.prm</span></code></p>
</dd>
<dt><code class="docutils literal"><span class="pre">treetransforms</span></code></dt>
<dd>A command line interface to perform transformations on
treebanks such as binarization.</dd>
<dt><code class="docutils literal"><span class="pre">grammar</span></code></dt>
<dd>A command line interface to read off grammars from (binarized)
treebanks.</dd>
<dt><code class="docutils literal"><span class="pre">treedraw</span></code></dt>
<dd><p class="first">Visualize (discontinuous) trees. Command-line interface:</p>
<p class="last"><code class="docutils literal"><span class="pre">$</span> <span class="pre">discodop</span> <span class="pre">treedraw</span> <span class="pre">&lt;</span> <span class="pre">negra-corpus.export</span> <span class="pre">|</span> <span class="pre">less</span> <span class="pre">-RS</span></code></p>
</dd>
<dt><code class="docutils literal"><span class="pre">parser</span></code></dt>
<dd>A basic command line interface to the parser comparable to bitpar.
Reads grammars from text files.</dd>
<dt><code class="docutils literal"><span class="pre">demos</span></code></dt>
<dd>Contains examples of various formalisms encoded in LCFRS grammars.</dd>
<dt><code class="docutils literal"><span class="pre">gen</span></code></dt>
<dd>An experiment in generation with LCFRS.</dd>
</dl>
<p>For instructions, pass the <code class="docutils literal"><span class="pre">--help</span></code> option to a command.</p>
</div>
<div class="section" id="web-interfaces">
<h2><a class="toc-backref" href="#id8">Web interfaces</a><a class="headerlink" href="#web-interfaces" title="Permalink to this headline">¶</a></h2>
<p>There are three web based tools in the <code class="docutils literal"><span class="pre">web/</span></code> directory. These require
Flask &amp; pandas to be installed:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install --user -r web/requirements.txt
</pre></div>
</div>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">parse.py</span></code></dt>
<dd>A web interface to the parser. Expects a series of grammars
in subdirectories of <code class="docutils literal"><span class="pre">web/grammars/</span></code>, each containing grammar files
as produced by running <code class="docutils literal"><span class="pre">discodop</span> <span class="pre">runexp</span></code>.
<a class="reference external" href="http://staff.science.uva.nl/~acranenb/grammars/">Download grammars</a>
for English, German, and Dutch, as used in the 2013 IWPT paper.</dd>
<dt><code class="docutils literal"><span class="pre">treesearch.py</span></code></dt>
<dd>A web interface for searching through treebanks. Expects
one or more treebanks with the <code class="docutils literal"><span class="pre">.mrg</span></code> or <code class="docutils literal"><span class="pre">.dact</span></code> extension in the
directory <code class="docutils literal"><span class="pre">web/corpus/</span></code> (sample included). Depends on
<a class="reference external" href="http://tedlab.mit.edu/~dr/Tgrep2/">tgrep2</a>,
<a class="reference external" href="https://github.com/rug-compling/alpinocorpus-python">alpinocorpus</a>, and
<a class="reference external" href="https://github.com/andreasvc/readability">readability</a>.</dd>
<dt><code class="docutils literal"><span class="pre">treedraw.py</span></code></dt>
<dd>A web interface for drawing discontinuous trees in various
formats.</dd>
</dl>
<img alt="screenshot of treesearch showing counts of pattern" src="_images/treesearch1.png" />
<img alt="screenshot of treesearch showing bar plot of pattern" src="_images/treesearch2.png" />
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#parsing-a-text">Parsing a text</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inducing-a-simple-grammar">Inducing a simple grammar</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-an-experiment">Run an experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ipython-notebooks">IPython notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#overview">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#command-line-tools">Command-line tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="#web-interfaces">Web interfaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ref.html">Reference</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="ref.html" title="Reference"
             >next</a></li>
        <li class="right" >
          <a href="index.html" title="Discontinuous Data-Oriented Parsing: disco-dop"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Disco-DOP 0.5pre1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Andreas van Cranenburgh.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>