<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>discodop.fragments &mdash; Disco-DOP 0.4.1pre1 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.4.1pre1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Disco-DOP 0.4.1pre1 documentation" href="../index.html" />
    <link rel="up" title="API documentation" href="../api.html" />
    <link rel="next" title="discodop.gen" href="discodop.gen.html" />
    <link rel="prev" title="discodop.eval" href="discodop.eval.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="discodop.gen.html" title="discodop.gen"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="discodop.eval.html" title="discodop.eval"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Disco-DOP 0.4.1pre1 documentation</a> &raquo;</li>
          <li><a href="../ref.html" >Reference</a> &raquo;</li>
          <li><a href="../api.html" accesskey="U">API documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-discodop.fragments">
<span id="discodop-fragments"></span><h1>discodop.fragments<a class="headerlink" href="#module-discodop.fragments" title="Permalink to this headline">¶</a></h1>
<p>Extract recurring tree fragments from constituency treebanks.</p>
<p>NB: there is a known bug in multiprocessing which makes it impossible to detect
Ctrl-C or fatal errors like segmentation faults in child processes which causes
the master program to wait forever for output from its children. Therefore if
you want to abort, kill the program manually (e.g., press Ctrl-Z and issue
&#8216;kill %1&#8217;). If the program seems stuck, re-run without multiprocessing
(pass &#8211;numproc 1) to see if there might be a bug.</p>
<p class="rubric">Functions</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#discodop.fragments.altrepr" title="discodop.fragments.altrepr"><tt class="xref py py-obj docutils literal"><span class="pre">altrepr</span></tt></a>(a)</td>
<td>Rewrite bracketed tree to alternative format.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#discodop.fragments.batch" title="discodop.fragments.batch"><tt class="xref py py-obj docutils literal"><span class="pre">batch</span></tt></a>(outputdir,&nbsp;filenames,&nbsp;limit,&nbsp;encoding,&nbsp;...)</td>
<td>batch processing: three or more treebanks specified.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#discodop.fragments.coverfragworker" title="discodop.fragments.coverfragworker"><tt class="xref py py-obj docutils literal"><span class="pre">coverfragworker</span></tt></a>(*args,&nbsp;**kwds)</td>
<td>Worker function that gets depth-1 fragments.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#discodop.fragments.debinarize" title="discodop.fragments.debinarize"><tt class="xref py py-obj docutils literal"><span class="pre">debinarize</span></tt></a>(fragments)</td>
<td>Debinarize fragments; fragments that fail to debinarize left as-is.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#discodop.fragments.exactcountworker" title="discodop.fragments.exactcountworker"><tt class="xref py py-obj docutils literal"><span class="pre">exactcountworker</span></tt></a>(*args,&nbsp;**kwds)</td>
<td>Worker function for counting of fragments.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#discodop.fragments.getfragments" title="discodop.fragments.getfragments"><tt class="xref py py-obj docutils literal"><span class="pre">getfragments</span></tt></a>(trees,&nbsp;sents[,&nbsp;numproc,&nbsp;disc,&nbsp;...])</td>
<td>Get recurring fragments with exact counts in a single treebank.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#discodop.fragments.initworker" title="discodop.fragments.initworker"><tt class="xref py py-obj docutils literal"><span class="pre">initworker</span></tt></a>(treebank1,&nbsp;treebank2,&nbsp;limit,&nbsp;encoding)</td>
<td>Read treebanks for this worker.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#discodop.fragments.initworkersimple" title="discodop.fragments.initworkersimple"><tt class="xref py py-obj docutils literal"><span class="pre">initworkersimple</span></tt></a>(trees,&nbsp;sents,&nbsp;disc[,&nbsp;...])</td>
<td>Initialization for a worker in which a treebank was already loaded.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#discodop.fragments.iteratefragments" title="discodop.fragments.iteratefragments"><tt class="xref py py-obj docutils literal"><span class="pre">iteratefragments</span></tt></a>(fragments,&nbsp;newtrees,&nbsp;...)</td>
<td>Get fragments of fragments.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#discodop.fragments.printfragments" title="discodop.fragments.printfragments"><tt class="xref py py-obj docutils literal"><span class="pre">printfragments</span></tt></a>(fragments,&nbsp;counts[,&nbsp;out])</td>
<td>Dump fragments to standard output or some other file object.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#discodop.fragments.read2ndtreebank" title="discodop.fragments.read2ndtreebank"><tt class="xref py py-obj docutils literal"><span class="pre">read2ndtreebank</span></tt></a>(treebank2,&nbsp;labels,&nbsp;prods[,&nbsp;...])</td>
<td>Read a second treebank.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#discodop.fragments.readtreebanks" title="discodop.fragments.readtreebanks"><tt class="xref py py-obj docutils literal"><span class="pre">readtreebanks</span></tt></a>(treebank1[,&nbsp;treebank2,&nbsp;fmt,&nbsp;...])</td>
<td>Read one or two treebanks.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#discodop.fragments.regular" title="discodop.fragments.regular"><tt class="xref py py-obj docutils literal"><span class="pre">regular</span></tt></a>(filenames,&nbsp;numproc,&nbsp;limit,&nbsp;encoding)</td>
<td>non-batch processing. multiprocessing optional.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#discodop.fragments.worker" title="discodop.fragments.worker"><tt class="xref py py-obj docutils literal"><span class="pre">worker</span></tt></a>(*args,&nbsp;**kwds)</td>
<td>Worker function for fragment extraction.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#discodop.fragments.workload" title="discodop.fragments.workload"><tt class="xref py py-obj docutils literal"><span class="pre">workload</span></tt></a>(numtrees,&nbsp;mult,&nbsp;numproc)</td>
<td>Calculate an even workload.</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="discodop.fragments.altrepr">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">altrepr</tt><big>(</big><em>a</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#altrepr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.altrepr" title="Permalink to this definition">¶</a></dt>
<dd><p>Rewrite bracketed tree to alternative format.</p>
<p>Replace double quotes with double single quotes: &#8221; -&gt; &#8216;&#8217;
Quote terminals with double quotes terminal: -&gt; &#8220;terminal&#8221;
Remove parentheses around frontier nodes: (NN ) -&gt; NN</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">altrepr</span><span class="p">(</span><span class="s">&quot;(NP (DT a) (NN ))&quot;</span><span class="p">)</span>
<span class="go">&#39;(NP (DT &quot;a&quot;) NN)&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.batch">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">batch</tt><big>(</big><em>outputdir</em>, <em>filenames</em>, <em>limit</em>, <em>encoding</em>, <em>debin</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.batch" title="Permalink to this definition">¶</a></dt>
<dd><p>batch processing: three or more treebanks specified.
The use case for this is when you have one big treebank which you want to
compare to lots of smaller sets of trees, and get the results for each
comparison in a separate file.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.coverfragworker">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">coverfragworker</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#coverfragworker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.coverfragworker" title="Permalink to this definition">¶</a></dt>
<dd><p>Worker function that gets depth-1 fragments.</p>
<p>Does not need multiprocessing but using it avoids reading the treebank
again.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.debinarize">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">debinarize</tt><big>(</big><em>fragments</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#debinarize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.debinarize" title="Permalink to this definition">¶</a></dt>
<dd><p>Debinarize fragments; fragments that fail to debinarize left as-is.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.exactcountworker">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">exactcountworker</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#exactcountworker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.exactcountworker" title="Permalink to this definition">¶</a></dt>
<dd><p>Worker function for counting of fragments.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.getfragments">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">getfragments</tt><big>(</big><em>trees</em>, <em>sents</em>, <em>numproc=1</em>, <em>disc=True</em>, <em>iterate=False</em>, <em>complement=False</em>, <em>indices=True</em>, <em>cover=True</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#getfragments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.getfragments" title="Permalink to this definition">¶</a></dt>
<dd><p>Get recurring fragments with exact counts in a single treebank.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a dictionary whose keys are fragments as strings, and
indices as values. When <tt class="docutils literal"><span class="pre">disc</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, keys are of the form
<tt class="docutils literal"><span class="pre">(frag,</span> <span class="pre">sent)</span></tt> where <tt class="docutils literal"><span class="pre">frag</span></tt> is a unicode string, and <tt class="docutils literal"><span class="pre">sent</span></tt>
is a list of words as unicode strings; when <tt class="docutils literal"><span class="pre">disc</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, keys
are of the form <tt class="docutils literal"><span class="pre">frag</span></tt> where <tt class="docutils literal"><span class="pre">frag</span></tt> is a unicode string.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>trees</strong> &#8211; a sequence of binarized Tree objects.</li>
<li><strong>numproc</strong> &#8211; number of processes to use; pass 0 to use detected # CPUs.</li>
<li><strong>disc</strong> &#8211; when disc=True, assume trees with discontinuous constituents.</li>
<li><strong>complement</strong> (<em>iterate,</em>) &#8211; see <tt class="xref py py-func docutils literal"><span class="pre">_fragments.extractfragments()</span></tt></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.initworker">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">initworker</tt><big>(</big><em>treebank1</em>, <em>treebank2</em>, <em>limit</em>, <em>encoding</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#initworker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.initworker" title="Permalink to this definition">¶</a></dt>
<dd><p>Read treebanks for this worker.</p>
<p>We do this separately for each process under the assumption that this is
advantageous with a NUMA architecture.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.initworkersimple">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">initworkersimple</tt><big>(</big><em>trees</em>, <em>sents</em>, <em>disc</em>, <em>trees2=None</em>, <em>sents2=None</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#initworkersimple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.initworkersimple" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialization for a worker in which a treebank was already loaded.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.iteratefragments">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">iteratefragments</tt><big>(</big><em>fragments</em>, <em>newtrees</em>, <em>newsents</em>, <em>trees</em>, <em>sents</em>, <em>numproc</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#iteratefragments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.iteratefragments" title="Permalink to this definition">¶</a></dt>
<dd><p>Get fragments of fragments.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.printfragments">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">printfragments</tt><big>(</big><em>fragments</em>, <em>counts</em>, <em>out=None</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#printfragments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.printfragments" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump fragments to standard output or some other file object.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.read2ndtreebank">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">read2ndtreebank</tt><big>(</big><em>treebank2</em>, <em>labels</em>, <em>prods</em>, <em>fmt='bracket'</em>, <em>limit=None</em>, <em>encoding='utf-8'</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#read2ndtreebank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.read2ndtreebank" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a second treebank.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.readtreebanks">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">readtreebanks</tt><big>(</big><em>treebank1</em>, <em>treebank2=None</em>, <em>fmt='bracket'</em>, <em>limit=None</em>, <em>encoding='utf-8'</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#readtreebanks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.readtreebanks" title="Permalink to this definition">¶</a></dt>
<dd><p>Read one or two treebanks.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.regular">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">regular</tt><big>(</big><em>filenames</em>, <em>numproc</em>, <em>limit</em>, <em>encoding</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#regular"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.regular" title="Permalink to this definition">¶</a></dt>
<dd><p>non-batch processing. multiprocessing optional.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.worker">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">worker</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#worker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.worker" title="Permalink to this definition">¶</a></dt>
<dd><p>Worker function for fragment extraction.</p>
</dd></dl>

<dl class="function">
<dt id="discodop.fragments.workload">
<tt class="descclassname">discodop.fragments.</tt><tt class="descname">workload</tt><big>(</big><em>numtrees</em>, <em>mult</em>, <em>numproc</em><big>)</big><a class="reference internal" href="../_modules/discodop/fragments.html#workload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#discodop.fragments.workload" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate an even workload.</p>
<p>When <em>n</em> trees are compared against themselves, <tt class="docutils literal"><span class="pre">n</span> <span class="pre">*</span> <span class="pre">(n</span> <span class="pre">-</span> <span class="pre">1)</span></tt> total
comparisons are made. Each tree <em>m</em> has to be compared to all trees <em>x</em>
such that <tt class="docutils literal"><span class="pre">m</span> <span class="pre">&lt;</span> <span class="pre">x</span> <span class="pre">&lt;=</span> <span class="pre">n</span></tt>
(meaning there are more comparisons for lower <em>n</em>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a sequence of <tt class="docutils literal"><span class="pre">(start,</span> <span class="pre">end)</span></tt> intervals such that
the number of comparisons is approximately balanced.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html#overview">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../ref.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../discodop.html">Command line options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../params.html">Parser parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fileformats.html">File formats</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html">API documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="discodop.gen.html" title="discodop.gen"
             >next</a></li>
        <li class="right" >
          <a href="discodop.eval.html" title="discodop.eval"
             >previous</a> |</li>
        <li><a href="../index.html">Disco-DOP 0.4.1pre1 documentation</a> &raquo;</li>
          <li><a href="../ref.html" >Reference</a> &raquo;</li>
          <li><a href="../api.html" >API documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Andreas van Cranenburgh.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>